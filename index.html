<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bói toán chính xác cho cuộc đời bạn</title>
  <style>
    body{margin:0;font-family:system-ui;background:#0b1220;color:#fff;display:flex;justify-content:center;padding:24px}
    .wrap{width:min(920px,100%);display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
    @media (max-width:860px){.wrap{grid-template-columns:1fr}}
    .card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.15);border-radius:16px;padding:16px}
    h1{margin:0 0 8px;font-size:24px}
    .muted{color:rgba(255,255,255,.7);font-size:13px;line-height:1.5}
    .q{margin-top:12px;padding:12px;border-radius:14px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12)}
    .row3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    @media (max-width:520px){.row3{grid-template-columns:1fr}}
    label{display:block;font-size:12px;color:rgba(255,255,255,.7);margin:8px 0 6px}
    input,textarea{width:100%;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,.18);background:rgba(0,0,0,.25);color:#fff;outline:none}
    textarea{min-height:90px;resize:vertical}
    .actions{display:flex;gap:10px;margin-top:12px}
    button{padding:12px 14px;border-radius:14px;border:0;cursor:pointer;font-weight:700}
    #submitBtn{flex:1;background:linear-gradient(135deg,#7c5cff,#b39cff)}
    #clearBtn{background:rgba(255,255,255,.08);color:#fff;border:1px solid rgba(255,255,255,.18)}
    .result{margin-top:10px;padding:12px;border-radius:14px;border:1px dashed rgba(255,255,255,.2);background:rgba(0,0,0,.2)}
    .big{margin-top:10px;padding:12px;border-radius:14px;border:1px solid rgba(46,229,157,.22);background:rgba(46,229,157,.08)}
    .name{font-size:18px;font-weight:850;margin:6px 0}
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card">
      <h1>Bói toán chính xác cho cuộc đời bạn</h1>
      <div class="muted">Điền khảo sát và bấm <b>Xem kết quả</b>. Kết quả sẽ luôn chọn <b>người số 1</b>.</div>

      <form id="surveyForm">
        <div class="q">
          <b>1) Hãy kể họ tên 3 người con gái bạn yêu.</b>
          <div class="row3" style="margin-top:10px">
            <div>
              <label>Người số 1</label>
              <input id="girl1" placeholder="Nguyễn Thị A" />
            </div>
            <div>
              <label>Người số 2</label>
              <input id="girl2" placeholder="Trần Thị B" />
            </div>
            <div>
              <label>Người số 3</label>
              <input id="girl3" placeholder="Lê Thị C" />
            </div>
          </div>
        </div>

        <div class="q">
          <b>2) Bạn kể 3 điểm mà bạn yêu ở người mà bạn yêu nhất.</b>
          <textarea id="like3" placeholder="1) ...
2) ...
3) ..."></textarea>
        </div>

        <div class="q">
          <b>3) Hãy kể 3 điểm bạn không thích của cô ấy.</b>
          <textarea id="dislike3" placeholder="1) ...
2) ...
3) ..."></textarea>
        </div>

        <div class="actions">
          <button id="submitBtn" type="submit">Xem kết quả</button>
          <button id="clearBtn" type="button">Xóa lịch sử</button>
        </div>
      </form>
    </section>

    <aside class="card">
      <b>Kết quả</b>
      <div id="resultBox" class="result">Chưa có kết quả.</div>

      <div id="chosenBox" class="big" style="display:none;">
        <div class="muted">Bạn đời tương lai (luôn là người số 1)</div>
        <div id="chosenName" class="name">—</div>
      </div>

      <div style="margin-top:14px">
        <b>Lịch sử (lưu trên trình duyệt)</b>
        <div id="historyList" class="muted" style="margin-top:8px">Chưa có.</div>
      </div>
    </aside>
  </main>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const STORAGE_KEY = "boi_toan_history_v1";
      const $ = (id) => document.getElementById(id);

      function nowText() {
        const d = new Date();
        const pad = (n) => String(n).padStart(2, "0");
        return `${pad(d.getDate())}/${pad(d.getMonth()+1)}/${d.getFullYear()} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
      }

      function readHistory(){
        try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
        catch { return []; }
      }
      function writeHistory(items){
        localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
      }

      function renderHistory(){
        const history = readHistory();
        const box = $("historyList");
        if(!history.length){ box.textContent = "Chưa có."; return; }

        box.innerHTML = history.map(h => `
          <div style="margin:10px 0;padding:10px;border:1px solid rgba(255,255,255,.12);border-radius:12px;background:rgba(255,255,255,.05)">
            <div><b>${h.title}</b> <span style="opacity:.7;font-size:12px">(${h.time})</span></div>
          </div>
        `).join("");
      }

      renderHistory();

      $("surveyForm").addEventListener("submit", (e) => {
        e.preventDefault();

        const girl1 = $("girl1").value.trim();
        const chosenName = girl1 || "Người số 1";

        // Hiển thị kết quả ngay lập tức (luôn người số 1)
        $("resultBox").innerHTML = `<b>Kết luận:</b> Bạn đời tương lai của bạn là <b>${chosenName}</b> ✨`;
        $("chosenBox").style.display = "block";
        $("chosenName").textContent = chosenName;

        // Lưu lịch sử
        const history = readHistory();
        history.unshift({
          time: nowText(),
          title: `Chốt kèo: ${chosenName} là bạn đời tương lai ✨`,
        });
        writeHistory(history.slice(0, 30));
        renderHistory();
      });

      $("clearBtn").addEventListener("click", () => {
        localStorage.removeItem(STORAGE_KEY);
        $("resultBox").textContent = "Đã xóa lịch sử.";
        $("chosenBox").style.display = "none";
        renderHistory();
      });
    });
  </script>
</body>
</html>
